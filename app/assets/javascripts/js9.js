var Mustache;(function(n){typeof module!="undefined"&&module.exports?module.exports=n:typeof define=="function"?define(n):Mustache=n})(function(){function w(n,t){return RegExp.prototype.test.call(n,t)}function b(n){return!w(v,n)}function e(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function k(n){return String(n).replace(/[&<>"'\/]/g,function(n){return s[n]})}function u(n){this.string=n;this.tail=n;this.pos=0}function i(n,t){this.view=n;this.parent=t;this.clearCache()}function t(){this.clearCache()}function d(n){for(var i=n[3],r=i,t;(t=n[4])&&t.length;)n=t[t.length-1],r=n[3];return[i,r]}function h(n){function i(n,i,r){if(!t[n]){var u=h(i);t[n]=function(n,t){return u(n,t,r)}}return t[n]}var t={};return function(t,r,u){for(var e="",f,s,o=0,h=n.length;o<h;++o){f=n[o];switch(f[0]){case"#":s=u.slice.apply(u,d(f));e+=t._section(f[1],r,s,i(o,f[4],u));break;case"^":e+=t._inverted(f[1],r,i(o,f[4],u));break;case">":e+=t._partial(f[1],r);break;case"&":e+=t._name(f[1],r);break;case"name":e+=t._escaped(f[1],r);break;case"text":e+=f[1]}}return e}}function g(n){for(var e=[],u=e,i=[],t,r,f=0;f<n.length;++f){t=n[f];switch(t[0]){case"#":case"^":t[4]=[];i.push(t);u.push(t);u=t[4];break;case"/":if(i.length===0)throw new Error("Unopened section: "+t[1]);if(r=i.pop(),r[1]!==t[1])throw new Error("Unclosed section: "+r[1]);u=i.length>0?i[i.length-1][4]:e;break;default:u.push(t)}}if(r=i.pop(),r)throw new Error("Unclosed section: "+r[1]);return e}function nt(n){for(var t,i,r=0;r<n.length;++r)t=n[r],i&&i[0]==="text"&&t[0]==="text"?(i[1]+=t[1],i[3]=t[3],n.splice(r--,1)):i=t}function c(n){if(n.length!==2)throw new Error("Invalid tags: "+n.join(" "));return[new RegExp(e(n[0])+"\\s*"),new RegExp("\\s*"+e(n[1]))]}var n={},f,s,r;n.name="mustache.js";n.version="0.7.0";n.tags=["{{","}}"];n.Scanner=u;n.Context=i;n.Writer=t;var l=/\s*/,a=/\s+/,v=/\S/,o=/\s*=/,y=/\s*\}/,p=/#|\^|\/|>|\{|&|=|!/;return f=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"},s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},n.escape=k,u.prototype.eos=function(){return this.tail===""},u.prototype.scan=function(n){var t=this.tail.match(n);return t&&t.index===0?(this.tail=this.tail.substring(t[0].length),this.pos+=t[0].length,t[0]):""},u.prototype.scanUntil=function(n){var t,i=this.tail.search(n);switch(i){case-1:t=this.tail;this.pos+=this.tail.length;this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i);this.tail=this.tail.substring(i);this.pos+=i}return t},i.make=function(n){return n instanceof i?n:new i(n)},i.prototype.clearCache=function(){this._cache={}},i.prototype.push=function(n){return new i(n,this)},i.prototype.lookup=function(n){var t=this._cache[n],i,r,u;if(!t){if(n===".")t=this.view;else for(i=this;i;){if(n.indexOf(".")>0)for(r=n.split("."),u=0,t=i.view;t&&u<r.length;)t=t[r[u++]];else t=i.view[n];if(t!=null)break;i=i.parent}this._cache[n]=t}return typeof t=="function"&&(t=t.call(this.view)),t},t.prototype.clearCache=function(){this._cache={};this._partialCache={}},t.prototype.compile=function(t,i){var r=this._cache[t],u;return r||(u=n.parse(t,i),r=this._cache[t]=this.compileTokens(u,t)),r},t.prototype.compilePartial=function(n,t,i){var r=this.compile(t,i);return this._partialCache[n]=r,r},t.prototype.compileTokens=function(n,t){var u=h(n),r=this;return function(n,f){if(f)if(typeof f=="function")r._loadPartial=f;else for(var e in f)r.compilePartial(e,f[e]);return u(r,i.make(n),t)}},t.prototype.render=function(n,t,i){return this.compile(n)(t,i)},t.prototype._section=function(n,t,i,r){var u=t.lookup(n),o,e,s,h,c;switch(typeof u){case"object":if(f(u)){for(o="",e=0,s=u.length;e<s;++e)o+=r(this,t.push(u[e]));return o}return u?r(this,t.push(u)):"";case"function":return h=this,c=function(n){return h.render(n,t)},u.call(t.view,i,c)||"";default:if(u)return r(this,t)}return""},t.prototype._inverted=function(n,t,i){var r=t.lookup(n);return!r||f(r)&&r.length===0?i(this,t):""},t.prototype._partial=function(n,t){n in this._partialCache||!this._loadPartial||this.compilePartial(n,this._loadPartial(n));var i=this._partialCache[n];return i?i(t):""},t.prototype._name=function(n,t){var i=t.lookup(n);return typeof i=="function"&&(i=i.call(t.view)),i==null?"":String(i)},t.prototype._escaped=function(t,i){return n.escape(this._name(t,i))},n.parse=function(t,i){function et(){if(rt&&!d)while(k.length)v.splice(k.pop(),1);else k=[];rt=!1;d=!1}var w,f,s,tt,it,ut,ft;i=i||n.tags;for(var h=c(i),r=new u(t),v=[],k=[],rt=!1,d=!1;!r.eos();){if(w=r.pos,s=r.scanUntil(h[0]),s)for(it=0,ut=s.length;it<ut;++it)tt=s.charAt(it),b(tt)?k.push(v.length):d=!0,v.push(["text",tt,w,w+1]),w+=1,tt==="\n"&&et();if(w=r.pos,!r.scan(h[0]))break;if(rt=!0,f=r.scan(p)||"name",r.scan(l),f==="="?(s=r.scanUntil(o),r.scan(o),r.scanUntil(h[1])):f==="{"?(ft=new RegExp("\\s*"+e("}"+i[1])),s=r.scanUntil(ft),r.scan(y),r.scanUntil(h[1]),f="&"):s=r.scanUntil(h[1]),!r.scan(h[1]))throw new Error("Unclosed tag at "+r.pos);v.push([f,s,w,r.pos]);(f==="name"||f==="{"||f==="&")&&(d=!0);f==="="&&(i=s.split(a),h=c(i))}return nt(v),g(v)},r=new t,n.clearCache=function(){return r.clearCache()},n.compile=function(n,t){return r.compile(n,t)},n.compilePartial=function(n,t,i){return r.compilePartial(n,t,i)},n.compileTokens=function(n,t){return r.compileTokens(n,t)},n.render=function(n,t,i){return r.render(n,t,i)},n.to_html=function(t,i,r,u){var f=n.render(t,i,r);if(typeof u=="function")u(f);else return f},n}())